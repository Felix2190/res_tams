<?php

	#----------------------------------------------------------------------------------------------------------------------#
	#-------------------------------------------------------Includes-------------------------------------------------------#
	#----------------------------------------------------------------------------------------------------------------------#
	
	
	
	#----------------------------------------------------------------------------------------------------------------------#
	#-------------------------------------------------------Funciones------------------------------------------------------#
	#----------------------------------------------------------------------------------------------------------------------#
	
		
	
	#----------------------------------------------------------------------------------------------------------------------#
	#-----------------------------------------------Procesamiento de comando-----------------------------------------------#
	#----------------------------------------------------------------------------------------------------------------------#
	
	
	
	$datos=$param;
	$email=$datos['email'];
	$pass=$datos['pass'];
	if (login($email, $pass, $dbLink))
	{
		$token=hash('sha512', uniqid(mt_rand(1, mt_getrandmax()), true));
		
		$App=new ModeloApp();
		$App->setIdLoginMember($_SESSION['idLoginMember']);
		$App->setToken($token);
		$App->setTiempo($_NOW_);
		$App->Guardar();
		
		$token.=rand(10000000,99999999) . $_SESSION['idLoginMember'];
		$respuesta=new clsAppGenericResponse();
		$respuesta->setMsg("");
		$respuesta->setResult("OK");
		$dataResponse=array("token"=>$token);
		$respuesta->setData($dataResponse);
		die($respuesta->getJSONResponse());
	}
	else
	{
		returnAppError("Ingreso denegado.");
	}