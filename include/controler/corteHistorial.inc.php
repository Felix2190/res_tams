<?php

	#-----------------------------------------------------------------------------------------------------------------#
	#---------------------------------------Archivos necesarios Require Include---------------------------------------#
	#-----------------------------------------------------------------------------------------------------------------#




	#-----------------------------------------------------------------------------------------------------------------#
	#--------------------------------------------Inicializacion de control--------------------------------------------#
	#-----------------------------------------------------------------------------------------------------------------#



	#-----------------------------------------------------------------------------------------------------------------#
	#-----------------------------------------------------------------------------------------------------------------#

	#-----------------------------------------------------------------------------------------------------------------#
	#----------------------------------------------------Funciones----------------------------------------------------#
	#-----------------------------------------------------------------------------------------------------------------#
	
	function calcularTablaCorteHistorial()
	{
		global $objSession;
		global $dbLink;
		
		//var_dump($objSession->getIdUbicacion());
		
		
		$query="SELECT idCorteCaja, totalEfectivo, totalTarjeta, total,fecha FROM cortecaja ORDER BY fecha DESC";
		
		$result=mysqli_query($dbLink, $query);
		if(!$result)
		{
			die("Error en la consulta");
		}
		
		$tabla="";
		while($r=mysqli_fetch_assoc($result))
		{
			
			
			$tabla.='<tr>
						<td>' . $r["idCorteCaja"] . '</td>
						<td>' . $r["fecha"] . '</td>
						<td>' . number_format($r["totalEfectivo"],2 , "." , ",") . '</td>
						<td>' . number_format($r["totalTarjeta"],2 , "." , ",") . '</td>
						<td>$ ' . number_format($r["total"],2 , "." , ",") . '</td>
						<td><a class="btn btn-default" href="exportCorteCSV.php?id=' . $r['idCorteCaja'] . '" target="_blank"><i class="fa fa-download"></i></a></td>
					</tr>';
			
		}
		
		return $tabla;
		
		/*
		<th>ID</th>
		<th>Externo</th>
		<th>Nombre(s)</th>
		<th>Apellidos</th>
		<th>Tipo de Licencia</th>
		<th>Opciones</th>
		*/
	}


	#-----------------------------------------------------------------------------------------------------------------#
	#-----------------------------------------------------------------------------------------------------------------#


	#-----------------------------------------------------------------------------------------------------------------#
	#---------------------------------------------------Seccion AJAX--------------------------------------------------#
	#-----------------------------------------------------------------------------------------------------------------#

	$xajax=new xajax();
	


		$xajax->processRequest();
	#-----------------------------------------------------------------------------------------------------------------#
	#-----------------------------------------------------------------------------------------------------------------#

	#-----------------------------------------------------------------------------------------------------------------#
	#-------------------------------------------Inicializacion de variables-------------------------------------------#
	#-----------------------------------------------------------------------------------------------------------------#
	
		
		$listadoHistorialCorte=calcularTablaCorteHistorial();
