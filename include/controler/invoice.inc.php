<?php

	#-----------------------------------------------------------------------------------------------------------------#
	#---------------------------------------Archivos necesarios Require Include---------------------------------------#
	#-----------------------------------------------------------------------------------------------------------------#

	require FOLDER_MODEL_WS . "ws.class.AccountServiceInvoicesList.inc.php";




	#-----------------------------------------------------------------------------------------------------------------#
	#--------------------------------------------Inicializacion de control--------------------------------------------#
	#-----------------------------------------------------------------------------------------------------------------#



	#-----------------------------------------------------------------------------------------------------------------#
	#-----------------------------------------------------------------------------------------------------------------#

	#-----------------------------------------------------------------------------------------------------------------#
	#----------------------------------------------------Funciones----------------------------------------------------#
	#-----------------------------------------------------------------------------------------------------------------#


	#-----------------------------------------------------------------------------------------------------------------#
	#-----------------------------------------------------------------------------------------------------------------#


	#-----------------------------------------------------------------------------------------------------------------#
	#---------------------------------------------------Seccion AJAX--------------------------------------------------#
	#-----------------------------------------------------------------------------------------------------------------#

	$xajax=new xajax();



	$xajax->processRequest();

	#-----------------------------------------------------------------------------------------------------------------#
	#-----------------------------------------------------------------------------------------------------------------#

	#-----------------------------------------------------------------------------------------------------------------#
	#-------------------------------------------Inicializacion de variables-------------------------------------------#
	#-----------------------------------------------------------------------------------------------------------------#

	$Invoices=new DAccountServiceInvoicesList();
	$Invoices->Param->setAccountId($objSession->getAccountId());
	$Invoices->execute();

	if($Invoices->getError())
		die($Invoices->getStrError());

	$cantidad=$Invoices->Response->getTotalRecords();

	$fecha=getdate();
	$dia=$objSession->detallesPlan['PeriodBase'];

	$fechas=array();


	$strInvoices="";


	foreach($Invoices->Response->getInvoicesList() AS $k=>$v)
	{

		$tt=explode("-",$v['Invoice']);
		$tt=$tt[1];
		$strInvoices.='
				<tr>
					<td>' . $v['Invoice'] . '</td>
					<td>'. $v['InvoiceDate'] .'</td>
					<td>' . abs($v['InvoiceAmount']) . ' ' . $objSession->getCurrencyName() . '</td>
					<td>' . $v['RemainingDue'] . ' ' . $objSession->getCurrencyName() . '</td>
					<td><a target="_blank" href="getInvoice.php?id=' . $tt . '" class="btn btn-transparent btn-xs" tooltip-placement="top" tooltip="Edit"><i class="fa fa-cloud-download"></i> Descargar</a></td>
				</tr>
				';

	}

