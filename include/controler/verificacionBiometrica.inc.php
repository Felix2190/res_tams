<?php

	require_once FOLDER_MODEL_EXTEND . "model.verificacion_biografica.inc.php";
	require_once FOLDER_MODEL_EXTEND . "model.turno.inc.php";
	
	#-------------------------------------------------------Includes-------------------------------------------------------#
	#----------------------------------------------------------------------------------------------------------------------#

	#----------------------------------------------------------------------------------------------------------------------#
	#-------------------------------------------------------Funciones------------------------------------------------------#

	#----------------------------------------------------------------------------------------------------------------------#
	#----------------------------------------------------------------------------------------------------------------------#
	#-----------------------------------------------------Seccion AJAX-----------------------------------------------------#
	#----------------------------------------------------------------------------------------------------------------------#

	$xajax=new xajax();

	 function validacionBiometrica($id,$validar)
	{
		global $objSession;
		$r=new xajaxResponse();
		
		$verBio=new ModeloVerificacion_biografica();
		$verBio->transaccionIniciar();
		$verBio->setIdVerificacionBiografica($id);
		
		$turno=new ModeloTurno();
		$turno->setIdTurno($verBio->getIdTurno());
		
		if ($validar){
			$turno->setIdEtapa(2);
			
		}else {
			$turno->setIdEtapa(3);
		}
		$turno->setFechaHora(date('Y-m-d H:i:s'));
		$turno->Guardar();
		if ($turno->getError()){
			$r->mostrarError('Error al actualizar turno');
			return $r;
		}
		
		$verBio->setVerificacionCerrada();
		
		$verBio->Guardar();
		if ($verBio->getError()){
			$r->mostrarError('Error al actualizar verificaci&oacute;n biogr&aaccute;fica');
			return $r;
		}
		$verBio->transaccionCommit();
		$r->mostrarAviso("Informaci&oacute;n guardada con exito.");
		
		
		$r->redirect("verificacionBiometrica.php",2);
		
		return $r;

	}
	$xajax->registerFunction("validacionBiometrica");

	$xajax->processRequest();


	#----------------------------------------------------------------------------------------------------------------------#
	#---------------------------------------------Procesamiento de formulario----------------------------------------------#
	#----------------------------------------------------------------------------------------------------------------------#




	#----------------------------------------------------------------------------------------------------------------------#
	#---------------------------------------------Inicializacion de variables----------------------------------------------#
	#----------------------------------------------------------------------------------------------------------------------#
	
		#----------------------------------------------------------------------------------------------------------------------#
	#-------------------------------------------------Salida de Javascript-------------------------------------------------#
	#----------------------------------------------------------------------------------------------------------------------#
